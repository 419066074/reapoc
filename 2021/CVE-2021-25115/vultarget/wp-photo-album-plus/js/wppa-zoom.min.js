var wppaJsZoomVersion="8.0.00.017";function wppaDoZoomPan(n,t){var m=jQuery;t&&(wppaZoomData[n]=t);var o=g(n);function h(t){var a,n,o,e,i,s=g(t);s.canvas&&(z()<s.time+10||(g(t,{time:z()}),(s.isLightbox&&!wppaOvlOpen||!s.isLightbox&&wppaOvlOpen)&&(s=g(0,{abort:!0})),s.abort?g(t,{manual:!1,buttondown:!1,pause:!1,ctx:null}):s.busy||(wppaDebugCounter++,(s=g(t,{busy:!0})).manual||(s.fromX+=s.deltaX,s.fromY+=s.deltaY,a=s.fromHeight/s.deltaFactor,n=s.fromWidth/s.deltaFactor,50<a&&1!=s.deltaFactor&&(wppaIsFs()||a<=s.image.height)?(s.fromX-=(n-s.fromWidth)/2,s.fromY-=(a-s.fromHeight)/2,s.fromWidth=n,s.fromHeight=a):s.buttondown=!1),s.fromX=Math.max(0,Math.min(s.image.width-s.fromWidth,s.fromX)),s.fromY=Math.max(0,Math.min(s.image.height-s.fromHeight,s.fromY)),o=screen.width/screen.height,e=(1-s.image.width/s.fromWidth)*s.canvas.width/2,i=(1-s.image.height/s.fromHeight)*s.canvas.height/2,s.ctx=s.canvas.getContext("2d"),o>s.imageRatio&&a>s.image.height&&wppaIsFs()||o<=s.imageRatio&&n>s.image.width&&wppaIsFs()?(s.enableManual=!1,s.ctx.clearRect(0,0,s.canvas.width,s.canvas.height),s.ctx.drawImage(s.image,s.fromX,s.fromY,s.fromWidth,s.fromHeight,e,i,s.canvas.width,s.canvas.height),jQuery(s.canvas).css({cursor:"default"})):(s.enableManual=!0,s.ctx.drawImage(s.image,s.fromX,s.fromY,s.fromWidth,s.fromHeight,0,0,s.canvas.width,s.canvas.height),jQuery(s.canvas).css({cursor:"grab"})),wppaIsFs()?(s.fsMaskTop=i-(s.canvas.height-screen.height)/2,s.fsMaskLeft=e-(s.canvas.width-screen.width)/2,s.fsMaskBottom=screen.height-s.fsMaskTop,s.fsMaskRight=screen.width-s.fsMaskLeft):(s.fsMaskTop=0,s.fsMaskLeft=0,s.fsMaskBottom=0,s.fsMaskRight=0),s.ctrlbarUpdate&&(wppaAdjustControlbar(),s.ctrlbarUpdate=!1),s.busy=!1,wppaIsElementInViewport(s.canvas)||(s.buttondown=!1),g(t,s),s.pause||!s.manual&&!s.buttondown||setTimeout(function(){h(t)},10),s.pause&&g(t,{pause:!1}))))}function a(t){var a,n,o,e,i,s,c,r,d,u=g(t);u&&(u.isLightbox?(m("#wppa-overlay-zpc").css("display",""),e=(n=!wppaIsFs())?(o=window.innerWidth||screen.width,window.innerHeight||screen.height):(o=screen.width,screen.height),c=0,d=(r=8)+(u.controls?u.icsize+10:0)+10,n?(r+=2*u.borderWidth,d+=2*u.borderWidth):r=40,a=n?e-d>(o-r)/u.imageRatio:(screenRatio=screen.width/screen.height,screenRatio<u.imageRatio),n&&a&&(c=(e-(s=(i=o-r)/u.imageRatio)-d)/2+20),n&&!a&&(s=(i=u.imageRatio*(e-(u.controls?u.icsize:0)-48))/u.imageRatio,c=20),!n&&a&&(i=(s=screen.height)*u.imageRatio,c=0),n||a||(s=(i=screen.width)/u.imageRatio,c=(screen.height-s)/2),m("#wppa-ovl-zoom-container").css({top:c}),m("#wppa-overlay-zpc").css({top:0,left:0}),u.canvasWidth=i,u.canvasHeight=s,u.canvas.width=u.canvasWidth,u.canvas.height=u.canvasHeight,n?(m("#wppa-ovl-zoom-container").css({backgroundColor:u.backgroundColor,padding:u.padding,borderRadius:u.borderRadius+"px",borderWidth:u.borderWidth+"px",width:i,marginLeft:0}),a?m("#wppa-overlay-zpc").css({left:4}):m("#wppa-overlay-zpc").css({left:(o-i)/2})):(m("#wppa-overlay-zpc").css({marginLeft:0}),m("#wppa-ovl-zoom-container").css({backgroundColor:"transparent",padding:0,borderRadius:"0px",borderWidth:"0px",width:i,left:(o-i)/2,position:"fixed"}))):(u.canvasWidth=m(u.div).parent().width(),u.canvasHeight=u.canvasWidth/u.imageRatio,u.canvas.width=u.canvasWidth,u.canvas.height=u.canvasHeight),u.ctrlbarUpdate=!0,g(t,u),setTimeout(function(){h(t)},250),m("#wppa-ovl-zoom-container").show())}function e(t){var a=g(t),a=a.image.naturalWidth/a.canvas.width;a<1.5&&(a=1.5),g(t,{deltaX:a*=1.5,buttondown:!0,manual:!1}),h(t)}function i(t){var a=g(t),a=a.image.naturalWidth/a.canvas.width;a<1.5&&(a=1.5),g(t,{deltaX:-(a*=1.5),buttondown:!0,manual:!1}),h(t)}function s(t){var a=g(t),a=a.image.naturalHeight/a.canvas.height;a<1.5&&(a=1.5),g(t,{deltaY:-(a*=1.5),buttondown:!0,manual:!1}),h(t)}function c(t){var a=g(t),a=a.image.naturalHeight/a.canvas.height;a<1.5&&(a=1.5),g(t,{deltaY:a*=1.5,buttondown:!0,manual:!1}),h(t)}function r(t){g(t,{deltaFactor:1.005,buttondown:!0,manual:!1}),h(t)}function u(t){g(t,{deltaFactor:.995,buttondown:!0,manual:!1}),h(t)}function p(t){g(t,{deltaX:0,deltaY:0,deltaFactor:1,buttondown:!1})}function f(t,a){var n=g(t),o=l(a).X,e=l(a).Y;if(wppaIsFs()&&n.isLightbox&&(o<n.fsMaskLeft||o>n.fsMaskRight||e<n.fsMaskTop||e>n.fsMaskBottom))return g(0,{abort:!0}),void jQuery("#wppa-overlay-bg").trigger("click");n.enableManual&&(g(t,{manual:!0,savedCanvasX:o=b(t,a).X,savedCanvasY:e=b(t,a).Y,buttondown:!1}),h(t))}function w(t,a){var n,o=g(t),e=b(t,a).X,i=b(t,a).Y;o.manual&&(n=o.canvas.width/o.fromWidth,a=(o.savedCanvasX-e)/n+o.fromX,n=(o.savedCanvasY-i)/n+o.fromY,0<a&&0<n&&a+o.fromWidth<o.image.width&&n+o.fromHeight<o.image.height&&g(t,{fromX:a,fromY:n,savedCanvasX:e,savedCanvasY:i}))}function v(t){g(t,{manual:!1})}function g(t,a){if(!wppaZoomData[t])return!1;if(a)for(var n in a)wppaZoomData[t][n]=a[n];return wppaZoomData[t]}function l(t){var a;return t=t.touches?(a=t.touches[0].screenX,t.touches[0].screenY):(a=t.screenX,t.screenY),{X:a,Y:t}}function b(t,a){var n;return a=a.touches?(t=g(t),n=a.touches[0].screenX-t.fsMaskLeft,a.touches[0].screenY-t.fsMaskTop):(n=a.offsetX,a.offsetY),{X:n,Y:a}}function z(){return d=new Date,d.getTime()}o.initialized||o.abort||(o.isLightbox&&(m("#wppa-ovl-spin").show(),m("#wppa-ovl-zoom-container").hide()),o.image.complete?(m(image).css({width:image.naturalWidth,height:image.naturalHeight,maxWidth:image.naturalWidth,maxHeight:image.naturalHeight}),o.manual=!1,o.deltaX=0,o.deltaY=0,o.deltaFactor=1,o.busy=!1,o.div=m("#wppa-pan-div-"+o.itemId),o.canvas=document.getElementById("wppa-pan-canvas-"+o.itemId),o.left=m("#wppa-pctl-left-"+o.itemId),o.right=m("#wppa-pctl-right-"+o.itemId),o.up=m("#wppa-pctl-up-"+o.itemId),o.down=m("#wppa-pctl-down-"+o.itemId),o.zoomin=m("#wppa-pctl-zoomin-"+o.itemId),o.zoomout=m("#wppa-pctl-zoomout-"+o.itemId),o.prev=m("#wppa-pctl-prev-"+o.itemId),o.next=m("#wppa-pctl-next-"+o.itemId),o.exit=m("#wppa-exit-btn-2"),o.canvasWidth=o.width,o.canvasHeight=o.height,o.savedCanvasX=0,o.savedCanvasY=0,o.fromHeight=o.image.height,o.fromWidth=o.image.width,o.imageRatio=o.image.width/o.image.height,o.fromX=0,o.fromY=0,o.centerX=o.fromX+o.fromWidth/2,o.centerY=o.fromY+o.fromHeight/2,o.ctx=null,o.buttondown=!1,o.enableManual=!0,o.ctrlbarUpdate=!0,o.pause=!1,o.time=0,o.right.on("touchstart",function(t){e(n)}),o.right.on("touchend",function(t){p(n)}),o.left.on("touchstart",function(t){i(n)}),o.left.on("touchend",function(t){p(n)}),o.up.on("touchstart",function(t){s(n)}),o.up.on("touchend",function(t){p(n)}),o.down.on("touchstart",function(t){c(n)}),o.down.on("touchend",function(t){p(n)}),o.zoomin.on("touchstart",function(t){r(n)}),o.zoomin.on("touchend",function(t){p(n)}),o.zoomout.on("touchstart",function(t){u(n)}),o.zoomout.on("touchend",function(t){p(n)}),o.canvas&&(o.canvas.addEventListener("touchstart",function(t){f(n,t)}),o.canvas.addEventListener("touchmove",function(t){w(n,t)}),o.canvas.addEventListener("touchend",function(t){v(n)})),o.canvas&&(o.canvas.addEventListener("mousedown",function(t){f(n,t)}),o.canvas.addEventListener("mousemove",function(t){w(n,t)}),o.canvas.addEventListener("mouseup",function(t){v(n)}),o.canvas.addEventListener("mouseleave",function(t){(o=g(n)).manual&&g(n,{pause:!0})}),o.canvas.addEventListener("mouseenter",function(t){var a;g(a=n,{pause:!1}).manual&&h(a)}),document.getElementById("wppa-pan-canvas-"+o.itemId).addEventListener("wheel",function(t){var a;a=n,(t=t).preventDefault(),t.stopPropagation(),o=g(a),g(a,{deltaFactor:1+t.deltaY*o.zoomsensitivity/(wppaIsChrome?1e4:1e3),manual:!1,burrondown:!1}),h(a),setTimeout(function(){g(a,{deltaFactor:1})},25)})),o.right.on("mousedown",function(t){e(n)}),o.right.on("mouseup",function(t){p(n)}),o.left.on("mousedown",function(t){i(n)}),o.left.on("mouseup",function(t){p(n)}),o.up.on("mousedown",function(t){s(n)}),o.up.on("mouseup",function(t){p(n)}),o.down.on("mousedown",function(t){c(n)}),o.down.on("mouseup",function(t){p(n)}),o.zoomin.off("mousedown"),o.zoomin.on("mousedown",function(t){r(n)}),o.zoomin.off("mouseup"),o.zoomin.on("mouseup",function(t){p(n)}),o.zoomout.on("mousedown",function(t){u(n)}),o.zoomout.on("mouseup",function(t){p(n)}),o.isLightbox&&(m("body").on("quitimage",function(t){o=g(n,{abort:!0}),m(o.canvas).hide(),m("#wppa-pctl-div-"+o.itemId).hide(),m("#wppa-ovl-zoom-container").hide()}),m("#wppa-pctl-div-"+o.itemId).on("click",function(t){wppaKillEvent(t)})),o.isLightbox?(m(window).off("resize",wppaOvlShowSame),m(window).on("resize",wppaOvlShowSame)):m(window).on("resize",function(t){a(n)}),a(n),o.initialized=!0,g(n,o),m("#wppa-ovl-spin").hide(),wppaProtect()):setTimeout(function(){wppaDoZoomPan(n)},200))}